<!-- AutoCheck BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Wed Sep 30 15:51:45 AEST 2015 -->
<bpel:process name="AutoCheck" targetNamespace="http://autocheck.soacourse.unsw.edu.au"
	suppressJoinFailure="yes" xmlns:tns="http://autocheck.soacourse.unsw.edu.au"
	xmlns:crv="http://crv.soacourse.unsw.edu.au" xmlns:pdv="http://pdv.soacourse.unsw.edu.au"
	xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
	exitOnStandardFault="yes">

	<!-- Import the client WSDL -->
	<bpel:import location="AutoCheckArtifacts.wsdl"
		namespace="http://autocheck.soacourse.unsw.edu.au" importType="http://schemas.xmlsoap.org/wsdl/" />
	<bpel:import location="PDV.wsdl" namespace="http://pdv.soacourse.unsw.edu.au"
		importType="http://schemas.xmlsoap.org/wsdl/" />
	<bpel:import location="CRV.wsdl" namespace="http://crv.soacourse.unsw.edu.au"
		importType="http://schemas.xmlsoap.org/wsdl/" />

	<!-- ================================================================= -->
	<!-- PARTNERLINKS -->
	<!-- List of services participating in this BPEL process -->
	<!-- ================================================================= -->
	<bpel:partnerLinks>
		<!-- The 'client' role represents the requester of this service. -->

		<bpel:partnerLink name="client" partnerLinkType="tns:AutoCheck"
			myRole="checker" />
		<bpel:partnerLink name="pdvChecker" partnerLinkType="tns:PDVCheck"
			partnerRole="checker" />
		<bpel:partnerLink name="crvChecker" partnerLinkType="tns:CRVCheck"
			partnerRole="checker" />
	</bpel:partnerLinks>

	<!-- ================================================================= -->
	<!-- VARIABLES -->
	<!-- List of messages and XML documents used within this BPEL process -->
	<!-- ================================================================= -->
	<bpel:variables>
		<!-- Reference to the message passed as input during initiation -->
		<bpel:variable name="input" messageType="tns:AutoCheckRequestMessage" />

		<bpel:variable name="inputPDV" messageType="pdv:PDVRequestMsg" />
		<bpel:variable name="outputPDV" messageType="pdv:PDVResponseMsg" />

		<bpel:variable name="inputCRV" messageType="crv:CRVRequestMsg" />
		<bpel:variable name="outputCRV" messageType="crv:CRVResponseMsg" />

		<!-- Reference to the message that will be returned to the requester -->
		<bpel:variable name="output" messageType="tns:AutoCheckResponseMessage" />
	</bpel:variables>

	<!-- ================================================================= -->
	<!-- ORCHESTRATION LOGIC -->
	<!-- Set of activities coordinating the flow of messages across the -->
	<!-- services integrated within this business process -->
	<!-- ================================================================= -->
	<bpel:sequence name="main">

		<!-- Receive input from requester. Note: This maps to operation defined 
			in AutoCheck.wsdl -->

		<bpel:receive name="receiveInput" partnerLink="client"
			portType="tns:AutoCheck" operation="autoCheckProcess" variable="input"
			createInstance="yes" />

		<!-- Generate reply to synchronous request -->








		<bpel:assign validate="no" name="AssignPDV1">
			<bpel:copy>
				<bpel:from>
					<bpel:literal>
						<tns:PDVRequest xmlns:tns="http://pdv.soacourse.unsw.edu.au"
							xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
							<licenseNumber>licenseNumber</licenseNumber>
							<fullName>fullName</fullName>
							<postcode>postcode</postcode>
						</tns:PDVRequest>
					</bpel:literal>
				</bpel:from>
				<bpel:to variable="inputPDV" part="parameters"></bpel:to>
			</bpel:copy>
			<bpel:copy>
				<bpel:from part="payload" variable="input">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:licenseNumber]]></bpel:query>
				</bpel:from>
				<bpel:to part="parameters" variable="inputPDV">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[licenseNumber]]></bpel:query>
				</bpel:to>
			</bpel:copy>
		</bpel:assign>
		<bpel:assign validate="no" name="AssignPDV2">
			<!-- <bpel:copy> -->
			<!-- <bpel:from> -->
			<!-- <bpel:literal> -->
			<!-- <tns:PDVRequest xmlns:tns="http://pdv.soacourse.unsw.edu.au" -->
			<!-- xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> -->
			<!-- <licenseNumber>licenseNumber</licenseNumber> -->
			<!-- <fullName>fullName</fullName> -->
			<!-- <postcode>postcode</postcode> -->
			<!-- </tns:PDVRequest> -->
			<!-- </bpel:literal> -->
			<!-- </bpel:from> -->
			<!-- <bpel:to variable="inputPDV" part="parameters"></bpel:to> -->
			<!-- </bpel:copy> -->
			<bpel:copy>
				<bpel:from part="payload" variable="input">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:fullName]]></bpel:query>
				</bpel:from>
				<bpel:to part="parameters" variable="inputPDV">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[fullName]]></bpel:query>
				</bpel:to>
			</bpel:copy>
		</bpel:assign>
		<bpel:assign validate="no" name="AssignPDV3">
			<!-- <bpel:copy> -->
			<!-- <bpel:from> -->
			<!-- <bpel:literal> -->
			<!-- <tns:PDVRequest xmlns:tns="http://pdv.soacourse.unsw.edu.au" -->
			<!-- xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> -->
			<!-- <licenseNumber>licenseNumber</licenseNumber> -->
			<!-- <fullName>fullName</fullName> -->
			<!-- <postcode>postcode</postcode> -->
			<!-- </tns:PDVRequest> -->
			<!-- </bpel:literal> -->
			<!-- </bpel:from> -->
			<!-- <bpel:to variable="inputPDV" part="parameters"></bpel:to> -->
			<!-- </bpel:copy> -->
			<bpel:copy>
				<bpel:from part="payload" variable="input">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:postcode]]></bpel:query>
				</bpel:from>
				<bpel:to part="parameters" variable="inputPDV">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[postcode]]></bpel:query>
				</bpel:to>
			</bpel:copy>
		</bpel:assign>
		<bpel:assign validate="no" name="AssignCRV">
			<bpel:copy>
				<bpel:from>
					<bpel:literal>
						<tns:CRVRequest xmlns:tns="http://crv.soacourse.unsw.edu.au"
							xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
							<licenseNumber>licenseNumber</licenseNumber>
						</tns:CRVRequest>
					</bpel:literal>
				</bpel:from>
				<bpel:to variable="inputCRV" part="parameters"></bpel:to>
			</bpel:copy>
			<bpel:copy>
				<bpel:from part="payload" variable="input">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:licenseNumber]]></bpel:query>
				</bpel:from>
				<bpel:to part="parameters" variable="inputCRV">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[licenseNumber]]></bpel:query>
				</bpel:to>
			</bpel:copy>
		</bpel:assign>





		<bpel:flow name="Flow">
			<bpel:invoke name="InvokePDV" partnerLink="pdvChecker"
				portType="pdv:PDVService" operation="PDVCheck" inputVariable="inputPDV"
				outputVariable="outputPDV">
			</bpel:invoke>
			<bpel:invoke name="InvokeCRV" partnerLink="crvChecker"
				portType="crv:CRVService" operation="CRVCheck" inputVariable="inputCRV"
				outputVariable="outputCRV">
			</bpel:invoke>
		</bpel:flow>

		<bpel:assign validate="no" name="AssignPDV1">
			<bpel:copy>
				<bpel:from>
					<bpel:literal>
						<tns:AutoCheckResponse xmlns:tns="http://autocheck.soacourse.unsw.edu.au"
							xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
							<tns:pdvcode>AllMatch</tns:pdvcode>
							<tns:pdvmsg>tns:pdvmsg</tns:pdvmsg>
							<tns:crvcode>CLEAN</tns:crvcode>
							<tns:crvmsg>tns:crvmsg</tns:crvmsg>
						</tns:AutoCheckResponse>
					</bpel:literal>
				</bpel:from>
				<bpel:to variable="output" part="payload"></bpel:to>
			</bpel:copy>
			<bpel:copy>
				<bpel:from part="parameters" variable="outputPDV">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[responseCode]]>
					</bpel:query>
				</bpel:from>
				<bpel:to part="payload" variable="output">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:pdvcode]]>
					</bpel:query>
				</bpel:to>
			</bpel:copy>
		</bpel:assign>
		<bpel:assign validate="no" name="AssignPDV2">
			<!-- <bpel:copy> -->
			<!-- <bpel:from> -->
			<!-- <bpel:literal> -->
			<!-- <tns:AutoCheckResponse xmlns:tns="http://autocheck.soacourse.unsw.edu.au" -->
			<!-- xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> -->
			<!-- <tns:pdvcode>AllMatch</tns:pdvcode> -->
			<!-- <tns:pdvmsg>tns:pdvmsg</tns:pdvmsg> -->
			<!-- </tns:AutoCheckResponse> -->
			<!-- </bpel:literal> -->
			<!-- </bpel:from> -->
			<!-- <bpel:to part="payload" variable="output"> -->
			<!-- <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:pdvmsg]]></bpel:query> -->
			<!-- </bpel:to> -->
			<!-- </bpel:copy> -->
			<bpel:copy>
				<bpel:from part="parameters" variable="outputPDV">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[responseMessage]]>
					</bpel:query>
				</bpel:from>
				<bpel:to part="payload" variable="output">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:pdvmsg]]>
					</bpel:query>
				</bpel:to>
			</bpel:copy>
		</bpel:assign>
		<bpel:assign validate="no" name="AssignCRV1">
<!-- 			<bpel:copy> -->
<!-- 				<bpel:from> -->
<!-- 					<bpel:literal> -->
<!-- 						<tns:AutoCheckResponse xmlns:tns="http://autocheck.soacourse.unsw.edu.au" -->
<!-- 							xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> -->
<!-- 							<tns:pdvcode>AllMatch</tns:pdvcode> -->
<!-- 							<tns:pdvmsg>tns:pdvmsg</tns:pdvmsg> -->
<!-- 							<tns:crvcode>CLEAN</tns:crvcode> -->
<!-- 							<tns:crvmsg>tns:crvmsg</tns:crvmsg> -->
<!-- 						</tns:AutoCheckResponse> -->
<!-- 					</bpel:literal> -->
<!-- 				</bpel:from> -->
<!-- 				<bpel:to variable="output" part="payload"></bpel:to> -->
<!-- 			</bpel:copy> -->
			<bpel:copy>
				<bpel:from part="parameters" variable="outputCRV">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[responseCode]]></bpel:query>
				</bpel:from>
				<bpel:to part="payload" variable="output">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:crvcode]]></bpel:query>
				</bpel:to>
			</bpel:copy>
		</bpel:assign>
		<bpel:assign validate="no" name="AssignCRV2">
<!-- 			<bpel:copy> -->
<!-- 				<bpel:from> -->
<!-- 					<bpel:literal> -->
<!-- 						<tns:AutoCheckResponse xmlns:tns="http://autocheck.soacourse.unsw.edu.au" -->
<!-- 							xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> -->
<!-- 							<tns:pdvcode>AllMatch</tns:pdvcode> -->
<!-- 							<tns:pdvmsg>tns:pdvmsg</tns:pdvmsg> -->
<!-- 							<tns:crvcode>CLEAN</tns:crvcode> -->
<!-- 							<tns:crvmsg>tns:crvmsg</tns:crvmsg> -->
<!-- 						</tns:AutoCheckResponse> -->
<!-- 					</bpel:literal> -->
<!-- 				</bpel:from> -->
<!-- 				<bpel:to variable="output" part="payload"></bpel:to> -->
<!-- 			</bpel:copy> -->
			<bpel:copy>
				<bpel:from part="parameters" variable="outputCRV">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[responseMessage]]></bpel:query>
				</bpel:from>
				<bpel:to part="payload" variable="output">
					<bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:crvmsg]]></bpel:query>
				</bpel:to>
			</bpel:copy>
		</bpel:assign>
		<bpel:reply name="replyOutput" partnerLink="client"
			portType="tns:AutoCheck" operation="autoCheckProcess" variable="output" />


	</bpel:sequence>
</bpel:process>

